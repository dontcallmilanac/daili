var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{O as s,r as i,a as u,o as c,b as d,c as p,d as m,w as f,F as v,e as y,t as g,f as b,g as S,h,v as _,i as k,j as w,k as x,l as C,m as I,A as R}from"./vendor.98d8a5f4.js";const U=e=>{const a=localStorage.getItem(e);return a?JSON.parse(a):null},F=(e,a)=>(localStorage.getItem(e)||localStorage.setItem(e,JSON.stringify({})),localStorage.setItem(e,JSON.stringify(a)),!0),j=async e=>{console.log("addEditThing",e);const s=U("THINGS")||[];if(e.key){const a=s.findIndex((a=>a.key===e.key));return void 0!==a&&(s.splice(a,1,e),F("THINGS",s),!0)}return s.push((i=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&r(e,t,a[t]);if(l)for(var t of l(a))n.call(a,t)&&r(e,t,a[t]);return e})({},e),u={key:Date.now()},a(i,t(u)))),F("THINGS",s),!0;var i,u},O=new s({region:"oss-cn-beijing",accessKeyId:window.btoa("-0\bæÑ\t;ØI*~i9ÅÀ"),accessKeySecret:window.atob("UU1MRnBSSHk4dnBjNEFaWXBGajhTSWhKdTJMY2FR"),bucket:"daili-0704"});const P={setup(e){const a=i(),t=u({pics:[]}),l=u({}),o=i([]),n=i(!1),r=i(!1),s=i(""),d=i([]),p=async()=>{const e=await(async e=>(console.log("getThingsList",e),(U("THINGS")||[]).sort(((e,a)=>a.key-e.key)).filter((a=>{const{master:t,category:l,name:o,color:n,season:r,position:s}=e;return(void 0===t||a.master===t)&&(void 0===l||a.category===l)&&(void 0===r||a.season.some((e=>e===r)))&&(void 0===o||a.name.includes(o))&&(void 0===n||a.color.includes(n))&&(void 0===s||a.position.includes(s))}))))(g(l));o.value=[...e]};return c(p),{rules:{master:[{required:!0,message:"必需项",type:"number"}],category:[{required:!0,message:"必需项",type:"number"}],name:[{required:!0,message:"必需项"}],color:[{required:!0,message:"必需项"}],season:[{required:!0,validator:(e,a)=>a.length<1?Promise.reject("必需项"):Promise.resolve()}],position:[{required:!0,message:"必需项"}]},labelCol:{span:4},wrapperCol:{span:20},formRef:a,formState:t,searchFormState:l,onCancel:()=>{n.value=!1},onSubmit:()=>{a.value.validate().then((async e=>{await j(g(t))?(p(),n.value=!1,y.success("保存成功")):y.error("保存失败")})).catch((e=>{console.log("validate error:",e)}))},onSearch:p,onAdd:()=>{a.value&&a.value.clearValidate(),n.value=!0,t.key=null,t.master="",t.category="",t.name="",t.color="",t.season=[],t.position="",t.pics=[],d.value=[]},onEdit:e=>{a.value&&a.value.clearValidate(),n.value=!0;const l=g(e);t.key=l.key,t.master=l.master,t.category=l.category,t.name=l.name,t.color=l.color,t.season=l.season,t.position=l.position,t.pics=l.pics,d.value=l.pics.map(((e,a)=>({uid:a,name:a,status:"done",url:e})))},onDelete:async e=>{await(async e=>{console.log("deleteThing",e);const a=U("THINGS"),t=a.findIndex((a=>a.key===e.key));return void 0!==t&&(a.splice(t,1),F("THINGS",a),!0)})(g(e))?(p(),y.success("删除成功")):y.error("删除失败")},fileList:d,previewVisible:r,previewImage:s,beforeUpload:e=>new Promise(((a,l)=>{l("取消默认上传，改为自定义上传"),async function(e){return new Promise(((a,t)=>{const l=e.type.split("/")[1];O.put(`${Date.now()}.${l}`,e).then((function(e){console.log("put success:",e),a(e)})).catch((function(e){console.error("put error:",e),t(e)}))}))}(e).then((e=>{200===e.res.status?(d.value.push({uid:d.value.length,name:d.value.length,status:"done",url:e.url}),t.pics=d.value.map((e=>e.url))):(console.log("200 err",e.res),y.error("请重试"))})).catch((e=>{console.log("not 200 err",e),y.error("请重试")}))})),handleCancel:()=>{r.value=!1},handlePreview:async e=>{s.value=e,r.value=!0},cates:["上衣","下装","鞋靴","内衣","美妆","箱包","配饰","家居","母婴","证件"],seasons:["春","夏","秋","冬"],masters:["毛","呆"],visible:n,dataSource:o,columns:[{title:"序号",slots:{customRender:"indexRender"}},{title:"主人",dataIndex:"master",slots:{customRender:"masterRender"}},{title:"种类",dataIndex:"category",slots:{customRender:"categoryRender"}},{title:"名称",dataIndex:"name"},{title:"颜色",dataIndex:"color"},{title:"季节",dataIndex:"season",slots:{customRender:"seasonRender"}},{title:"位置",dataIndex:"position"},{title:"图片",dataIndex:"pics",width:300,slots:{customRender:"picsRender"}},{title:"操作",width:200,slots:{customRender:"operRender"}}],pagination:{pageSize:50}}}},T=w("搜索"),N=w(" 添加 "),G={key:0},H=m("div",{class:"ant-upload-text"},"上传",-1),L=w("确认"),q=w(" 取消 "),D=w("修改"),E=w("删除");P.render=function(e,a,t,l,o,n){const r=b("a-select-option"),s=b("a-select"),i=b("a-form-item"),u=b("a-col"),c=b("a-input"),y=b("a-row"),g=b("a-button"),C=b("a-form"),I=b("a-checkbox-group"),R=b("a-upload"),U=b("a-modal"),F=b("a-popconfirm"),j=b("a-table");return d(),p(v,null,[m(C,{model:l.searchFormState,"label-col":l.labelCol,"wrapper-col":l.wrapperCol,style:{position:"sticky",top:"0","z-index":"1","background-color":"#fafafa","padding-top":"20px"}},{default:f((()=>[m(y,null,{default:f((()=>[m(u,{span:6},{default:f((()=>[m(i,{label:"主人"},{default:f((()=>[m(s,{value:l.searchFormState.master,"onUpdate:value":a[1]||(a[1]=e=>l.searchFormState.master=e),allowClear:!0},{default:f((()=>[(d(!0),p(v,null,S(l.masters,((e,a)=>(d(),p(r,{key:a,value:a},{default:f((()=>[w(x(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1}),m(u,{span:6},{default:f((()=>[m(i,{label:"种类"},{default:f((()=>[m(s,{value:l.searchFormState.category,"onUpdate:value":a[2]||(a[2]=e=>l.searchFormState.category=e),allowClear:!0},{default:f((()=>[(d(!0),p(v,null,S(l.cates,((e,a)=>(d(),p(r,{key:a,value:a},{default:f((()=>[w(x(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1}),m(u,{span:6},{default:f((()=>[m(i,{label:"名称"},{default:f((()=>[m(c,{value:l.searchFormState.name,"onUpdate:value":a[3]||(a[3]=e=>l.searchFormState.name=e)},null,8,["value"])])),_:1})])),_:1}),m(u,{span:6},{default:f((()=>[m(i,{label:"颜色"},{default:f((()=>[m(c,{value:l.searchFormState.color,"onUpdate:value":a[4]||(a[4]=e=>l.searchFormState.color=e)},null,8,["value"])])),_:1})])),_:1})])),_:1}),m(y,null,{default:f((()=>[m(u,{span:6},{default:f((()=>[m(i,{label:"季节"},{default:f((()=>[m(s,{value:l.searchFormState.season,"onUpdate:value":a[5]||(a[5]=e=>l.searchFormState.season=e),allowClear:!0},{default:f((()=>[(d(!0),p(v,null,S(l.seasons,((e,a)=>(d(),p(r,{key:a,value:e},{default:f((()=>[w(x(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1}),m(u,{span:6},{default:f((()=>[m(i,{label:"位置"},{default:f((()=>[m(c,{value:l.searchFormState.position,"onUpdate:value":a[6]||(a[6]=e=>l.searchFormState.position=e)},null,8,["value"])])),_:1})])),_:1}),m(u,{span:6},{default:f((()=>[m(g,{type:"primary",onClick:l.onSearch},{default:f((()=>[T])),_:1},8,["onClick"]),m(g,{style:{"margin-left":"20px"},onClick:l.onAdd},{default:f((()=>[N])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["model","label-col","wrapper-col"]),m(U,{visible:l.visible,"onUpdate:visible":a[16]||(a[16]=e=>l.visible=e),title:"添加物品",footer:null,zIndex:1},{default:f((()=>[m(C,{ref:"formRef",model:l.formState,"label-col":l.labelCol,"wrapper-col":l.wrapperCol,rules:l.rules},{default:f((()=>[h(m(i,{label:"key",name:"key"},{default:f((()=>[m(c,{disabled:!0,value:l.formState.key,"onUpdate:value":a[7]||(a[7]=e=>l.formState.key=e)},null,8,["value"])])),_:1},512),[[_,l.formState.key]]),m(i,{label:"主人",name:"master"},{default:f((()=>[m(s,{value:l.formState.master,"onUpdate:value":a[8]||(a[8]=e=>l.formState.master=e)},{default:f((()=>[(d(!0),p(v,null,S(l.masters,((e,a)=>(d(),p(r,{key:a,value:a},{default:f((()=>[w(x(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),m(i,{label:"种类",name:"category"},{default:f((()=>[m(s,{value:l.formState.category,"onUpdate:value":a[9]||(a[9]=e=>l.formState.category=e)},{default:f((()=>[(d(!0),p(v,null,S(l.cates,((e,a)=>(d(),p(r,{key:a,value:a},{default:f((()=>[w(x(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),m(i,{label:"名称",name:"name"},{default:f((()=>[m(c,{value:l.formState.name,"onUpdate:value":a[10]||(a[10]=e=>l.formState.name=e)},null,8,["value"])])),_:1}),m(i,{label:"颜色",name:"color"},{default:f((()=>[m(c,{value:l.formState.color,"onUpdate:value":a[11]||(a[11]=e=>l.formState.color=e)},null,8,["value"])])),_:1}),m(i,{label:"季节",name:"season"},{default:f((()=>[m(I,{value:l.formState.season,"onUpdate:value":a[12]||(a[12]=e=>l.formState.season=e),options:l.seasons},null,8,["value","options"])])),_:1}),m(i,{label:"位置",name:"position"},{default:f((()=>[m(c,{value:l.formState.position,"onUpdate:value":a[13]||(a[13]=e=>l.formState.position=e)},null,8,["value"])])),_:1}),h(m(i,{label:"",name:"pics"},null,512),[[_,!1]]),m(i,{label:"图片"},{default:f((()=>[m(R,{beforeUpload:l.beforeUpload,"list-type":"picture-card","file-list":l.fileList,"onUpdate:file-list":a[14]||(a[14]=e=>l.fileList=e),onPreview:a[15]||(a[15]=e=>{l.handlePreview(e.url)}),accept:"image/*"},{default:f((()=>[l.fileList.length<5?(d(),p("div",G,[H])):k("",!0)])),_:1},8,["beforeUpload","file-list"])])),_:1}),m(i,{"wrapper-col":{span:14,offset:4}},{default:f((()=>[m(g,{type:"primary",onClick:l.onSubmit},{default:f((()=>[L])),_:1},8,["onClick"]),m(g,{style:{"margin-left":"10px"},onClick:l.onCancel},{default:f((()=>[q])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","label-col","wrapper-col","rules"])])),_:1},8,["visible"]),m(U,{visible:l.previewVisible,footer:null,onCancel:l.handleCancel,zIndex:2},{default:f((()=>[m("img",{alt:"图片预览",style:{width:"100%"},src:l.previewImage},null,8,["src"])])),_:1},8,["visible","onCancel"]),m(j,{dataSource:l.dataSource,columns:l.columns,pagination:l.pagination},{indexRender:f((({index:e})=>[w(x(e+1),1)])),masterRender:f((({text:e})=>[w(x(l.masters[e]),1)])),categoryRender:f((({text:e})=>[w(x(l.cates[e]),1)])),seasonRender:f((({text:e})=>[w(x(e.join(",")),1)])),picsRender:f((({text:e})=>[(d(!0),p(v,null,S(e,((e,a)=>(d(),p("span",{key:a},[m("img",{src:e,style:{"max-width":"50px","max-height":"50px",cursor:"pointer"},onClick:a=>l.handlePreview(e)},null,8,["src","onClick"])])))),128))])),operRender:f((({record:e})=>[m(g,{onClick:a=>l.onEdit(e)},{default:f((()=>[D])),_:2},1032,["onClick"]),m(F,{title:"确认删除?",onConfirm:a=>l.onDelete(e),placement:"topRight"},{default:f((()=>[m(g,{type:"danger",style:{"margin-left":"20px"}},{default:f((()=>[E])),_:1})])),_:2},1032,["onConfirm"])])),_:1},8,["dataSource","columns","pagination"])],64)};const z=C({name:"App",components:{ThingsList:P}});z.render=function(e,a,t,l,o,n){const r=b("ThingsList");return d(),p(r)};const A=I(z);A.use(R),A.mount("#app");
